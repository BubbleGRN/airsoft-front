import{p as Y,aY as Z,aE as G,E as H,P as J,aZ as K,a_ as _,c as B,U as ee,a$ as ae,b0 as z,d as l,W as O,u as te,ai as le,aS as re,R as x,r as oe,o as L,b as se,w as o,aM as ue,ap as p,an as R,ao as v,aO as de,aU as M,X as ie,g as ne,aq as ce,e as s,aV as pe,aN as me,aP as ve,aQ as ge,aW as Ve,aX as be,F as fe,ar as ye,ac as ke}from"./index-Htbi3-bx.js";import{c as Ce,a as T,b as Pe,e as he,u as xe,d as $,V as $e}from"./index.esm-OAcP6EZH.js";import{V as Ae,a as W,b as X}from"./route-block-B72S4lfn.js";import{V as we}from"./VDivider-DISm40Zc.js";import{m as Se,b as j,V as Fe,a as Re}from"./VDataTable-DfUjkGuR.js";import{V as Ue}from"./VToolbar-DA8hQO5K.js";import{V as qe}from"./VContainer-C_m1Qos4.js";import{V as De}from"./VTextarea-Deb8Jyrv.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VPagination-DKMwnqdM.js";import"./VList-B3X0lAdv.js";import"./ssrBoot-BvMbKQsZ.js";import"./VMenu-Baq7YJwj.js";import"./VSlideGroup-DnDCSFrw.js";const Ie=Y({...Z(),...G(Se(),["inline"])},"VCheckbox"),Me=H()({name:"VCheckbox",inheritAttrs:!1,props:Ie(),emits:{"update:modelValue":n=>!0,"update:focused":n=>!0},setup(n,t){let{attrs:C,slots:m}=t;const c=J(n,"modelValue"),{isFocused:P,focus:U,blur:A}=K(n),d=_(),w=B(()=>n.id||`checkbox-${d}`);return ee(()=>{const[S,q]=ae(C),D=z.filterProps(n),F=j.filterProps(n);return l(z,O({class:["v-checkbox",n.class]},S,D,{modelValue:c.value,"onUpdate:modelValue":h=>c.value=h,id:w.value,focused:P.value,style:n.style}),{...m,default:h=>{let{id:g,messagesId:V,isDisabled:b,isReadonly:f,isValid:y}=h;return l(j,O(F,{id:g.value,"aria-describedby":V.value,disabled:b.value,readonly:f.value},q,{error:y.value===!1,modelValue:c.value,"onUpdate:modelValue":I=>c.value=I,onFocus:U,onBlur:A}),m)}})}),{}}}),Te={class:"text-center"},Be={__name:"products",setup(n){const{t}=te(),{apiAuth:C}=ye(),m=le(),c=re([]),P=x(""),U=B(()=>[{title:"ID",key:"_id",sortable:!0},{title:t("product.image"),key:"image",sortable:!1},{title:t("product.name"),key:"name",sortable:!0},{title:t("product.description"),key:"description",sortable:!0},{title:t("product.price"),key:"price",sortable:!0},{title:t("product.category"),key:"category",sortable:!0},{title:t("product.sell"),key:"sell",sortable:!0},{title:t("product.createdAt"),key:"createdAt",sortable:!0},{title:t("product.updatedAt"),key:"updatedAt",sortable:!0},{title:t("adminProduct.edit"),key:"edit",sortable:!1}]),A=async()=>{var a,r;try{const{data:i}=await C.get("/product/all");c.push(...i.result)}catch(i){console.log(i),m({text:t("api."+(((r=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};A();const d=x({open:!1,id:""}),w=a=>{a&&(d.value.id=a._id,g.value.value=a.name,V.value.value=a.price,b.value.value=a.description,f.value.value=a.category,y.value.value=a.sell),d.value.open=!0},S=()=>{h(),d.value.id="",d.value.open=!1,E.value.deleteFileRecord()},q=Ce({name:T().required(t("api.productNameRequired")),price:Pe().typeError(t("api.productPriceRequired")).required(t("api.productPriceRequired")).min(0,t("api.productPriceTooSmall")),description:T().required(t("api.productDescriptionRequired")),category:T().required(t("api.productCategoryRequired")).oneOf(["gun","vest","backpack","helmat","bb","others"],t("api.productCategoryInvalid")),sell:he().required(t("api.productSellRequired"))}),{handleSubmit:D,isSubmitting:F,resetForm:h}=xe({validationSchema:q,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),g=$("name"),V=$("price"),b=$("description"),f=$("category"),y=$("sell"),I=B(()=>[{text:t("productCategory.gun"),value:"gun"},{text:t("productCategory.vest"),value:"vest"},{text:t("productCategory.backpack"),value:"backpack"},{text:t("productCategory.helmat"),value:"helmat"},{text:t("productCategory.bb"),value:"bb"},{text:t("productCategory.others"),value:"others"}]),E=x(null),k=x([]),N=x([]),Q=D(async a=>{var r,i,e;if(!((r=k.value[0])!=null&&r.error)){if(d.value.id.length===0&&k.value.length===0){m({text:t("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const u=new FormData;u.append("name",a.name),u.append("price",a.price),u.append("description",a.description),u.append("category",a.category),u.append("sell",a.sell),k.value.length>0&&u.append("image",k.value[0].file),d.value.id.length>0?await C.patch("/product/"+d.value.id,u):await C.post("/product",u),c.splice(0,c.length),A(),m({text:t(d.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),S()}catch(u){console.log(u),m({text:t("api."+(((e=(i=u==null?void 0:u.response)==null?void 0:i.data)==null?void 0:e.message)||"unknownError")),snackbarProps:{color:"red"}})}}});return(a,r)=>{const i=oe("VueFileAgent");return L(),se(fe,null,[l(qe,null,{default:o(()=>[l(Ae,null,{default:o(()=>[l(W,{cols:"12"},{default:o(()=>[ue("h1",Te,p(a.$t("nav.adminProducts")),1)]),_:1}),l(we),l(W,{cols:"12"},{default:o(()=>[l(Fe,{items:c,headers:U.value,search:P.value},{top:o(()=>[l(Ue,null,{default:o(()=>[l(R,{onClick:r[0]||(r[0]=e=>w(null))},{default:o(()=>[v(p(a.$t("adminProduct.new")),1)]),_:1}),l(de),l(M,{modelValue:P.value,"onUpdate:modelValue":r[1]||(r[1]=e=>P.value=e),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":o(({value:e})=>[l(ie,{src:e,height:"50"},null,8,["src"])]),"item.sell":o(({value:e})=>[e?(L(),ne(ke,{key:0,icon:"mdi-check"})):ce("",!0)]),"item.createdAt":o(({value:e})=>[v(p(new Date(e).toLocaleString()),1)]),"item.updatedAt":o(({value:e})=>[v(p(new Date(e).toLocaleString()),1)]),"item.category":o(({value:e})=>[v(p(a.$t("productCategory."+e)),1)]),"item.edit":o(({item:e})=>[l(R,{icon:"mdi-pencil",variant:"text",onClick:u=>w(e)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),l(be,{modelValue:d.value.open,"onUpdate:modelValue":r[9]||(r[9]=e=>d.value.open=e),persistent:""},{default:o(()=>[l($e,{disabled:s(F),onSubmit:pe(s(Q),["prevent"])},{default:o(()=>[l(me,null,{default:o(()=>[l(ve,null,{default:o(()=>[v(p(a.$t(d.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),l(ge,null,{default:o(()=>[l(M,{modelValue:s(g).value.value,"onUpdate:modelValue":r[2]||(r[2]=e=>s(g).value.value=e),label:a.$t("product.name"),"error-messages":s(g).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(M,{modelValue:s(V).value.value,"onUpdate:modelValue":r[3]||(r[3]=e=>s(V).value.value=e),label:a.$t("product.price"),"error-messages":s(V).errorMessage.value,type:"number",min:"0"},null,8,["modelValue","label","error-messages"]),l(Re,{modelValue:s(f).value.value,"onUpdate:modelValue":r[4]||(r[4]=e=>s(f).value.value=e),"error-messages":s(f).errorMessage.value,items:I.value,label:a.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","items","label"]),l(Me,{modelValue:s(y).value.value,"onUpdate:modelValue":r[5]||(r[5]=e=>s(y).value.value=e),label:a.$t("product.onSell"),"error-messages":s(y).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(De,{modelValue:s(b).value.value,"onUpdate:modelValue":r[6]||(r[6]=e=>s(b).value.value=e),label:a.$t("product.description"),"error-messages":s(b).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(i,{ref_key:"fileAgent",ref:E,modelValue:k.value,"onUpdate:modelValue":r[7]||(r[7]=e=>k.value=e),"raw-model-value":N.value,"onUpdate:rawModelValue":r[8]||(r[8]=e=>N.value=e),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":a.$t("fileAgent.helpText"),"error-text":{type:a.$t("fileAgent.errorType"),size:a.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),l(Ve,null,{default:o(()=>[l(R,{onClick:S},{default:o(()=>[v(p(a.$t("adminProduct.cancel")),1)]),_:1}),l(R,{type:"submit",loading:s(F)},{default:o(()=>[v(p(a.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof X=="function"&&X(Be);export{Be as default};
