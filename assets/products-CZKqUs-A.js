import{v as Q,aY as X,aE as G,I as H,S as J,aZ as K,a_ as _,c as B,W as ee,a$ as ae,b0 as z,f as l,Y as O,u as te,ak as le,aS as re,r as x,d as oe,o as j,e as se,g as o,aM as ue,ap as p,an as q,ao as v,aO as de,aU as M,Z as ie,j as ne,aq as ce,h as s,aV as pe,aN as me,aP as ve,aQ as ge,aW as Ve,aX as be,F as fe,ar as ye,ae as ke}from"./index-BQZt8b2F.js";import{c as Ce,a as T,b as he,e as Pe,u as xe,d as $,V as $e}from"./index.esm-D84NKFD9.js";import{b as L}from"./route-block-B_A1xBdJ.js";import{V as Ae,a as W}from"./VRow-3_XE63Ap.js";import{V as Se}from"./VDivider-DnAYQ5DI.js";import{m as we,b as Y,V as Fe,a as qe}from"./VDataTable-hId4yT-z.js";import{V as Re}from"./VToolbar-DpgYEi9E.js";import{V as Ue}from"./VContainer-D5KAEAVp.js";import{V as De}from"./VTextarea-CoQU4D6R.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VPagination-aFAVUP6h.js";import"./VList-Df5CnQIx.js";import"./ssrBoot-Ctkdb1H4.js";import"./VMenu-Dg9o6oCX.js";import"./VSlideGroup-BpVDdD6h.js";const Ie=Q({...X(),...G(we(),["inline"])},"VCheckbox"),Me=H()({name:"VCheckbox",inheritAttrs:!1,props:Ie(),emits:{"update:modelValue":n=>!0,"update:focused":n=>!0},setup(n,t){let{attrs:C,slots:m}=t;const c=J(n,"modelValue"),{isFocused:h,focus:R,blur:A}=K(n),d=_(),S=B(()=>n.id||`checkbox-${d}`);return ee(()=>{const[w,U]=ae(C),D=z.filterProps(n),F=Y.filterProps(n);return l(z,O({class:["v-checkbox",n.class]},w,D,{modelValue:c.value,"onUpdate:modelValue":P=>c.value=P,id:S.value,focused:h.value,style:n.style}),{...m,default:P=>{let{id:g,messagesId:V,isDisabled:b,isReadonly:f,isValid:y}=P;return l(Y,O(F,{id:g.value,"aria-describedby":V.value,disabled:b.value,readonly:f.value},U,{error:y.value===!1,modelValue:c.value,"onUpdate:modelValue":I=>c.value=I,onFocus:R,onBlur:A}),m)}})}),{}}}),Te={class:"text-center"},Be={__name:"products",setup(n){const{t}=te(),{apiAuth:C}=ye(),m=le(),c=re([]),h=x(""),R=B(()=>[{title:"ID",key:"_id",sortable:!0},{title:t("product.image"),key:"image",sortable:!1},{title:t("product.name"),key:"name",sortable:!0},{title:t("product.description"),key:"description",sortable:!0},{title:t("product.price"),key:"price",sortable:!0},{title:t("product.category"),key:"category",sortable:!0},{title:t("product.sell"),key:"sell",sortable:!0},{title:t("product.createdAt"),key:"createdAt",sortable:!0},{title:t("product.updatedAt"),key:"updatedAt",sortable:!0},{title:t("adminProduct.edit"),key:"edit",sortable:!1}]),A=async()=>{var a,r;try{const{data:i}=await C.get("/product/all");c.push(...i.result)}catch(i){console.log(i),m({text:t("api."+(((r=(a=i==null?void 0:i.response)==null?void 0:a.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};A();const d=x({open:!1,id:""}),S=a=>{a&&(d.value.id=a._id,g.value.value=a.name,V.value.value=a.price,b.value.value=a.description,f.value.value=a.category,y.value.value=a.sell),d.value.open=!0},w=()=>{P(),d.value.id="",d.value.open=!1,N.value.deleteFileRecord()},U=Ce({name:T().required(t("api.productNameRequired")),price:he().typeError(t("api.productPriceRequired")).required(t("api.productPriceRequired")).min(0,t("api.productPriceTooSmall")),description:T().required(t("api.productDescriptionRequired")),category:T().required(t("api.productCategoryRequired")).oneOf(["gun","vest","backpack","helmat","bb","others"],t("api.productCategoryInvalid")),sell:Pe().required(t("api.productSellRequired"))}),{handleSubmit:D,isSubmitting:F,resetForm:P}=xe({validationSchema:U,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),g=$("name"),V=$("price"),b=$("description"),f=$("category"),y=$("sell"),I=B(()=>[{text:t("productCategory.gun"),value:"gun"},{text:t("productCategory.vest"),value:"vest"},{text:t("productCategory.backpack"),value:"backpack"},{text:t("productCategory.helmat"),value:"helmat"},{text:t("productCategory.bb"),value:"bb"},{text:t("productCategory.others"),value:"others"}]),N=x(null),k=x([]),E=x([]),Z=D(async a=>{var r,i,e;if(!((r=k.value[0])!=null&&r.error)){if(d.value.id.length===0&&k.value.length===0){m({text:t("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const u=new FormData;u.append("name",a.name),u.append("price",a.price),u.append("description",a.description),u.append("category",a.category),u.append("sell",a.sell),k.value.length>0&&u.append("image",k.value[0].file),d.value.id.length>0?await C.patch("/product/"+d.value.id,u):await C.post("/product",u),c.splice(0,c.length),A(),m({text:t(d.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),w()}catch(u){console.log(u),m({text:t("api."+(((e=(i=u==null?void 0:u.response)==null?void 0:i.data)==null?void 0:e.message)||"unknownError")),snackbarProps:{color:"red"}})}}});return(a,r)=>{const i=oe("VueFileAgent");return j(),se(fe,null,[l(Ue,null,{default:o(()=>[l(Ae,null,{default:o(()=>[l(W,{cols:"12"},{default:o(()=>[ue("h1",Te,p(a.$t("nav.adminProducts")),1)]),_:1}),l(Se),l(W,{cols:"12"},{default:o(()=>[l(Fe,{items:c,headers:R.value,search:h.value},{top:o(()=>[l(Re,null,{default:o(()=>[l(q,{onClick:r[0]||(r[0]=e=>S(null))},{default:o(()=>[v(p(a.$t("adminProduct.new")),1)]),_:1}),l(de),l(M,{modelValue:h.value,"onUpdate:modelValue":r[1]||(r[1]=e=>h.value=e),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":o(({value:e})=>[l(ie,{src:e,height:"50"},null,8,["src"])]),"item.sell":o(({value:e})=>[e?(j(),ne(ke,{key:0,icon:"mdi-check"})):ce("",!0)]),"item.createdAt":o(({value:e})=>[v(p(new Date(e).toLocaleString()),1)]),"item.updatedAt":o(({value:e})=>[v(p(new Date(e).toLocaleString()),1)]),"item.category":o(({value:e})=>[v(p(a.$t("productCategory."+e)),1)]),"item.edit":o(({item:e})=>[l(q,{icon:"mdi-pencil",variant:"text",onClick:u=>S(e)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),l(be,{modelValue:d.value.open,"onUpdate:modelValue":r[9]||(r[9]=e=>d.value.open=e),persistent:""},{default:o(()=>[l($e,{disabled:s(F),onSubmit:pe(s(Z),["prevent"])},{default:o(()=>[l(me,null,{default:o(()=>[l(ve,null,{default:o(()=>[v(p(a.$t(d.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),l(ge,null,{default:o(()=>[l(M,{modelValue:s(g).value.value,"onUpdate:modelValue":r[2]||(r[2]=e=>s(g).value.value=e),label:a.$t("product.name"),"error-messages":s(g).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(M,{modelValue:s(V).value.value,"onUpdate:modelValue":r[3]||(r[3]=e=>s(V).value.value=e),label:a.$t("product.price"),"error-messages":s(V).errorMessage.value,type:"number",min:"0"},null,8,["modelValue","label","error-messages"]),l(qe,{modelValue:s(f).value.value,"onUpdate:modelValue":r[4]||(r[4]=e=>s(f).value.value=e),"error-messages":s(f).errorMessage.value,items:I.value,label:a.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","items","label"]),l(Me,{modelValue:s(y).value.value,"onUpdate:modelValue":r[5]||(r[5]=e=>s(y).value.value=e),label:a.$t("product.onSell"),"error-messages":s(y).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(De,{modelValue:s(b).value.value,"onUpdate:modelValue":r[6]||(r[6]=e=>s(b).value.value=e),label:a.$t("product.description"),"error-messages":s(b).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(i,{ref_key:"fileAgent",ref:N,modelValue:k.value,"onUpdate:modelValue":r[7]||(r[7]=e=>k.value=e),"raw-model-value":E.value,"onUpdate:rawModelValue":r[8]||(r[8]=e=>E.value=e),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":a.$t("fileAgent.helpText"),"error-text":{type:a.$t("fileAgent.errorType"),size:a.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),l(Ve,null,{default:o(()=>[l(q,{onClick:w},{default:o(()=>[v(p(a.$t("adminProduct.cancel")),1)]),_:1}),l(q,{type:"submit",loading:s(F)},{default:o(()=>[v(p(a.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof L=="function"&&L(Be);export{Be as default};
