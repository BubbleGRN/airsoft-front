import{u as J,ai as K,a as Y,aS as Z,R as f,c as _,r as ee,o as ae,b as te,d as l,w as n,aM as p,ap as m,aT as le,e as r,an as V,ao as o,aO as ne,aU as b,X as re,aN as z,aP as L,aQ as O,aV as oe,aW as se,aX as ie,F as ue,ar as de}from"./index-CMVAtAc_.js";import{c as pe,a as y,b as me,u as ve,d as g,V as ce}from"./index.esm-U-22T3Al.js";import{b as X}from"./route-block-B_A1xBdJ.js";import{V as D,a as R}from"./VRow-BuFDYy08.js";import{V as ge}from"./VDivider-BJBSxoLd.js";import{V as fe,a as Ve}from"./VDataTable-DcIbkEd3.js";import{V as be}from"./VToolbar-CAglJcfI.js";import{V as ye}from"./VContainer-BO_Yah70.js";import{V as ke}from"./VTextarea-DmkYt58P.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VPagination-t4JrE0sv.js";import"./VList-D8HTXj51.js";import"./ssrBoot-BmKw3PEL.js";import"./VMenu-4I7vFpTW.js";import"./VSlideGroup-DIM7eqBs.js";const we={class:"text-center"},$e={__name:"activity",setup(xe){const{t:s}=J(),{apiAuth:k}=de(),v=K(),U=Y(),w=Z([]),F=f(""),G=_(()=>[{title:s("event.name"),key:"name",sortable:!1},{title:s("event.image"),key:"image",sortable:!1},{title:s("event.date"),key:"date",sortable:!0},{title:s("event.location"),key:"location",sortable:!0},{title:s("event.description"),key:"description",sortable:!1},{title:s("event.price"),key:"price",sortable:!0},{title:s("event.status"),key:"status",sortable:!0},{title:s("adminEvent.edit"),key:"edit",sortable:!1}]),M=async()=>{var t,e;try{const{data:u}=await k.get("/event/all");console.log(u.result),w.push(...u.result)}catch(u){console.log(u),v({text:s("api."+(((e=(t=u==null?void 0:u.response)==null?void 0:t.data)==null?void 0:e.message)||"unknownError")),snackbarProps:{color:"red"}})}};M();const Q=[{text:"叛徒遊戲",value:"叛徒遊戲: 依人數兩隊之中2~3人為敵對叛徒，叛徒主要任務為暗中清除自方的所有選手，而非叛徒的選手則是要將叛徒與敵隊射殺。這之中2~3分鐘在地圖的某處會有卡片可得知叛徒的部分特徵。"},{text:"劇情扮演",value:"劇情扮演: 雙方各分配一半人數進行對戰，一但雙方人數減少至一半時，被出局人與神秘人進行第三隊的加入，至於 一、二 隊可依照自行意願是否加入敵隊(僅一 、 二 隊)進行合作，主要任務為第三隊全滅勝利。"}],d=f({open:!1,id:""}),A=t=>{t&&(d.value.id=t._id,$.value.value=t.name,x.value.value=t.date,S.value.value=t.location,q.value.value=t.price,C.value.value=t.description,E.value=t.status),d.value.open=!0},P=f(null),T=()=>{h(),d.value.id="",d.value.open=!1,P.value.deleteFileRecord()},W=pe({name:y().required(s("api.eventNameRequired")),date:y().required(s("api.eventDateRequired")),location:y().required(s("api.eventLocationRequired")),description:y().required(s("api.eventDescriptionRequired")),status:y().required(s("api.eventStatusRequired")),price:me().required(s("api.eventPriceRequired"))}),{handleSubmit:B,isSubmitting:I,resetForm:h}=ve({validationSchema:W,initialValues:{name:"",date:"",location:"",description:"",status:"",price:""}}),$=g("name"),x=g("date"),S=g("location"),C=g("description"),q=g("price"),E=g("status"),c=f([]),j=f([]),N=B(async t=>{var e,u,a;if(console.log(t),!((e=c.value[0])!=null&&e.error)){if(d.value.id.length===0&&c.value.length===0){v({text:s("api.eventImageRequired"),snackbarProps:{color:"red"}});return}try{const i=new FormData;i.append("name",t.name),i.append("price",t.price),i.append("description",t.description),i.append("location",t.location),i.append("status",t.status),i.append("date",t.date),c.value.length>0&&i.append("image",c.value[0].file),d.value.id.length>0?await k.patch("/event/"+d.value.id,i):await k.post("/event",i),w.splice(0,w.length),M(),v({text:s(d.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),T()}catch(i){console.log(i),v({text:s("api."+(((a=(u=i==null?void 0:i.response)==null?void 0:u.data)==null?void 0:a.message)||"unknownError")),snackbarProps:{color:"red"}})}}}),H=async t=>{var e,u;try{const a={eventId:t._id,userId:U.id};await k.post("/user/join-event",a),v({text:s("event.joinSuccess"),snackbarProps:{color:"green"}})}catch(a){v({text:s("api."+(((u=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:u.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(t,e)=>{const u=ee("VueFileAgent");return ae(),te(ue,null,[l(ye,{class:"backgroundIMG",style:{"margin-left":"0px","margin-right":"0px","max-width":"1903px"}},{default:n(()=>[l(D,{style:{position:"relative",top:"80px"}},{default:n(()=>[l(R,{cols:"12"},{default:n(()=>[p("h1",we,m(t.$t("nav.adminEvents")),1)]),_:1}),l(ge),l(R,{cols:"12"},{default:n(()=>[l(fe,{items:w,headers:G.value,search:F.value,"items-per-page":"5",style:{border:"5px solid #D1C18B"}},le({top:n(()=>[l(be,null,{default:n(()=>[l(V,{onClick:e[0]||(e[0]=a=>A(null))},{default:n(()=>[o(m(t.$t("adminEvent.new")),1)]),_:1}),l(ne),l(b,{modelValue:F.value,"onUpdate:modelValue":e[1]||(e[1]=a=>F.value=a),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.name":n(({value:a})=>[o(m(a),1)]),"item.image":n(({value:a})=>[l(re,{src:a,height:"50"},null,8,["src"])]),"item.date":n(({value:a})=>[o(m(new Date(a).toLocaleDateString()),1)]),"item.price":n(({value:a})=>[o(m(a),1)]),"item.join":n(({item:a})=>[l(V,{class:"bg-primary-darken-1",variant:"text",onClick:i=>H(a)},{default:n(()=>e[12]||(e[12]=[o("加入")])),_:2},1032,["onClick"])]),_:2},[r(U).role===1?{name:"item.edit",fn:n(({item:a})=>[l(V,{icon:"mdi-pencil",variant:"text",onClick:i=>A(a)},null,8,["onClick"])]),key:"0"}:void 0]),1032,["items","headers","search"])]),_:1})]),_:1}),l(D,null,{default:n(()=>e[13]||(e[13]=[o(" ")])),_:1}),l(D,null,{default:n(()=>e[14]||(e[14]=[o(" ")])),_:1}),l(D,{class:"pt-3"},{default:n(()=>[l(R,null,{default:n(()=>[l(z,{class:"bg-primary"},{default:n(()=>[l(L,{style:{"text-align":"center"}},{default:n(()=>e[15]||(e[15]=[o("注意事項:")])),_:1}),l(O,{style:{"text-align":"center"}},{default:n(()=>e[16]||(e[16]=[o("1. 安全須知: "),p("br",null,null,-1),o(" 裝備準備：生存遊戲可能需要特定的裝備，例如防水衣物、登山靴、急救包、食物和水等。"),p("br",null,null,-1),o(" 環境危險：如果是在野外環境進行遊戲，需了解可能的危險，如野生動物、天氣變化、地形隱患等。"),p("br",null,null,-1),o(" 急救常識：在遇到意外情況時，懂得一些急救技能，如處理割傷、骨折、脫水等狀況。"),p("br",null,null,-1),o(" 2. 心理挑戰: "),p("br",null,null,-1),o(" 應對壓力：生存遊戲中的不確定性和挑戰會考驗你的心理素質，如何保持冷靜並作出正確決策是非常重要的。"),p("br",null,null,-1),o(" 耐性和毅力：遊戲過程中可能會遇到困難，鍾大智需要保持毅力，面對挑戰不輕言放棄。"),p("br",null,null,-1),o(" 3. 倫理和規範: "),p("br",null,null,-1),o(" 遵守規則：遊戲中通常有明確的行為規範，避免作弊或不公平行為，尊重其他玩家。"),p("br",null,null,-1),o(" 尊重環境：如果遊戲進行在戶外，要注意環保和可持續性，避免破壞自然環境。"),p("br",null,null,-1)])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ie,{modelValue:d.value.open,"onUpdate:modelValue":e[11]||(e[11]=a=>d.value.open=a),persistent:"","max-width":"600px"},{default:n(()=>[l(ce,{disabled:r(I),onSubmit:oe(r(N),["prevent"])},{default:n(()=>[l(z,null,{default:n(()=>[l(L,null,{default:n(()=>[o(m(d.value.id?t.$t("adminEvent.edit"):t.$t("adminEvent.new")),1)]),_:1}),l(O,null,{default:n(()=>[l(b,{modelValue:r($).value.value,"onUpdate:modelValue":e[2]||(e[2]=a=>r($).value.value=a),label:t.$t("event.name"),"error-messages":r($).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(Ve,{modelValue:r(E).value.value,"onUpdate:modelValue":e[3]||(e[3]=a=>r(E).value.value=a),"item-title":"text",items:Q,label:t.$t("event.status"),"error-messages":r(E).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(b,{modelValue:r(x).value.value,"onUpdate:modelValue":e[4]||(e[4]=a=>r(x).value.value=a),label:t.$t("event.date"),"error-messages":r(x).errorMessage.value,type:"date"},null,8,["modelValue","label","error-messages"]),l(b,{modelValue:r(S).value.value,"onUpdate:modelValue":e[5]||(e[5]=a=>r(S).value.value=a),label:t.$t("event.location"),"error-messages":r(S).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(ke,{modelValue:r(C).value.value,"onUpdate:modelValue":e[6]||(e[6]=a=>r(C).value.value=a),label:t.$t("event.description"),"error-messages":r(C).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(b,{modelValue:r(q).value.value,"onUpdate:modelValue":e[7]||(e[7]=a=>r(q).value.value=a),label:t.$t("event.price"),"error-messages":r(q).errorMessage.value,type:"number"},null,8,["modelValue","label","error-messages"]),l(u,{ref_key:"fileAgent",ref:P,modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=a=>c.value=a),"raw-model-value":j.value,"onUpdate:rawModelValue":e[9]||(e[9]=a=>j.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":t.$t("fileAgent.helpText"),"error-text":{type:t.$t("fileAgent.errorType"),size:t.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),l(se,null,{default:n(()=>[l(V,{onClick:T},{default:n(()=>[o(m(t.$t("adminEvent.cancel")),1)]),_:1}),l(V,{type:"submit",loading:r(I),onClick:e[10]||(e[10]=a=>r(B)(r(N)))},{default:n(()=>[o(m(t.$t("adminEvent.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof X=="function"&&X($e);export{$e as default};
