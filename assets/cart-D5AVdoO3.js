import{a as $,aj as q,ai as z,u as L,R,c as V,o as l,g as d,w as r,d as a,aM as h,ap as u,am as D,ao as p,aq as b,b as x,f as F,F as C,an as m,b9 as M,X as P,ar as j}from"./index-CtDhdyze.js";import{b as w}from"./route-block-B_A1xBdJ.js";import{a as f,V as G}from"./VRow-x7kAPGRT.js";import{V as A}from"./VDivider-ERXyJTrn.js";import{V as T,a as U}from"./VList-DPo4Pztw.js";import{V as B}from"./VContainer-CbU6f64m.js";import{V as X}from"./VAlert-CNwdsx0H.js";import"./ssrBoot-BZHApnGt.js";const H={class:"text-center"},J={__name:"cart",setup(K){const{apiAuth:i}=j(),g=$(),E=q(),k=z(),{t:y}=L(),o=R([]),v=async()=>{try{const{data:e}=await i.get("/user/cart");o.value=e.result}catch(e){console.log(e)}};v();const I=V(()=>o.value.reduce((e,s)=>e+s.product.price*s.quantity,0)),N=V(()=>o.value.length>0&&o.value.every(e=>e.product.sell)),_=async(e,s)=>{var t,n;try{const{data:c}=await i.patch("/user/cart",{product:e,quantity:s});g.cart=c.result,v()}catch(c){console.log(c),k({text:y("api."+(((n=(t=c==null?void 0:c.response)==null?void 0:t.data)==null?void 0:n.message)||"unknownError")),snackbarProps:{color:"red"}})}},S=async()=>{var e,s;try{await i.post("/order"),g.cart=0,E.push("/orders")}catch(t){console.log(t),k({text:y("api."+(((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(e,s)=>(l(),d(B,{class:"backgroundIMG",style:{"margin-left":"0px","margin-right":"0px","max-width":"1903px"}},{default:r(()=>[a(G,{style:{position:"relative",top:"80px"}},{default:r(()=>[a(f,{cols:"12"},{default:r(()=>[h("h1",H,u(e.$t("nav.cart")),1)]),_:1}),a(A),a(f,{cols:"12"},{default:r(()=>[a(T,{lines:"two",style:D(o.value.length===0?{background:"transparent"}:{border:"5px solid #7A9A5E"})},{default:r(()=>[o.value.length===0?(l(),d(B,{key:0,class:"text-center"},{default:r(()=>[a(X,{type:"info",color:"grey lighten-4",class:"ma-4"},{default:r(()=>s[0]||(s[0]=[p(" 無資料，可至商城購買物品 ")])),_:1})]),_:1})):b("",!0),(l(!0),x(C,null,F(o.value,(t,n)=>(l(),x(C,{key:t._id},[a(U,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-red",active:!t.product.sell},{prepend:r(()=>[a(M,{rounded:"0"},{default:r(()=>[a(P,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:r(()=>[a(m,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:c=>_(t.product._id,-1)},null,8,["onClick"]),p(" "+u(t.quantity)+" ",1),a(m,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:c=>_(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),n<o.value.length-1?(l(),d(A,{key:0})):b("",!0)],64))),128))]),_:1},8,["style"])]),_:1}),a(f,{cols:"12",class:"text-center"},{default:r(()=>[h("p",null,u(I.value),1),a(m,{color:"primary",disabled:!N.value,onClick:S},{default:r(()=>[p(u(e.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof w=="function"&&w(J);export{J as default};
