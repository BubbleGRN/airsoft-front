import{u as H,ak as J,a as K,aS as Y,r as f,c as _,d as ee,o as ae,e as te,f as l,g as n,aM as p,ap as m,aT as le,h as r,an as V,ao as s,aO as ne,aU as b,Z as re,aN as z,aP as L,aQ as O,aV as oe,aW as se,aX as ie,F as ue,ar as de}from"./index-UR6t7LWQ.js";import{c as pe,a as k,b as me,u as ve,d as g,V as ce}from"./index.esm-CeVDuEnI.js";import{b as h}from"./route-block-B_A1xBdJ.js";import{V as D,a as U}from"./VRow-C0F7vqWP.js";import{V as ge}from"./VDivider-z7DtT3J7.js";import{V as fe,a as Ve}from"./VDataTable-BuLwBBVI.js";import{V as be}from"./VToolbar-C_ujljF1.js";import{V as ke}from"./VContainer-CTkW8SnP.js";import{V as ye}from"./VTextarea-BWMCFNO7.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VPagination-B0wVlwFX.js";import"./VList-C_ekoX4d.js";import"./ssrBoot-DpYCysiW.js";import"./VMenu-CSA1IOhN.js";import"./VSlideGroup-6vR-rC_Y.js";const $e={class:"text-center"},we={__name:"activity",setup(xe){const{t:o}=H(),{apiAuth:y}=de(),v=J(),M=K(),$=Y([]),F=f(""),G=_(()=>[{title:o("event.name"),key:"name",sortable:!1},{title:o("event.image"),key:"image",sortable:!1},{title:o("event.date"),key:"date",sortable:!0},{title:o("event.location"),key:"location",sortable:!0},{title:o("event.description"),key:"description",sortable:!1},{title:o("event.price"),key:"price",sortable:!0},{title:o("event.status"),key:"status",sortable:!0},{title:o("adminEvent.edit"),key:"edit",sortable:!1},{title:o("event.join"),key:"join",sortable:!1}]),R=async()=>{var t,e;try{const{data:u}=await y.get("/event/all");console.log(u.result),$.push(...u.result)}catch(u){console.log(u),v({text:o("api."+(((e=(t=u==null?void 0:u.response)==null?void 0:t.data)==null?void 0:e.message)||"unknownError")),snackbarProps:{color:"red"}})}};R();const Q=[{text:"叛徒遊戲",value:"叛徒遊戲: 依人數兩隊之中2~3人為敵對叛徒，叛徒主要任務為暗中清除自方的所有選手，而非叛徒的選手則是要將叛徒與敵隊射殺。這之中2~3分鐘在地圖的某處會有卡片可得知叛徒的部分特徵。"},{text:"劇情扮演",value:"劇情扮演: 雙方各分配一半人數進行對戰，一但雙方人數減少至一半時，被出局人與神秘人進行第三隊的加入，至於 一、二 隊可依照自行意願是否加入敵隊(僅一 、 二 隊)進行合作，主要任務為第三隊全滅勝利。"}],d=f({open:!1,id:""}),A=t=>{t&&(d.value.id=t._id,w.value.value=t.name,x.value.value=t.date,S.value.value=t.location,q.value.value=t.price,C.value.value=t.description,E.value=t.status),d.value.open=!0},P=f(null),T=()=>{X(),d.value.id="",d.value.open=!1,P.value.deleteFileRecord()},W=pe({name:k().required(o("api.eventNameRequired")),date:k().required(o("api.eventDateRequired")),location:k().required(o("api.eventLocationRequired")),description:k().required(o("api.eventDescriptionRequired")),status:k().required(o("api.eventStatusRequired")),price:me().required(o("api.eventPriceRequired"))}),{handleSubmit:j,isSubmitting:B,resetForm:X}=ve({validationSchema:W,initialValues:{name:"",date:"",location:"",description:"",status:"",price:""}}),w=g("name"),x=g("date"),S=g("location"),C=g("description"),q=g("price"),E=g("status"),c=f([]),I=f([]),N=j(async t=>{var e,u,a;if(console.log(t),!((e=c.value[0])!=null&&e.error)){if(d.value.id.length===0&&c.value.length===0){v({text:o("api.eventImageRequired"),snackbarProps:{color:"red"}});return}try{const i=new FormData;i.append("name",t.name),i.append("price",t.price),i.append("description",t.description),i.append("location",t.location),i.append("status",t.status),i.append("date",t.date),c.value.length>0&&i.append("image",c.value[0].file),d.value.id.length>0?await y.patch("/event/"+d.value.id,i):await y.post("/event",i),$.splice(0,$.length),R(),v({text:o(d.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),T()}catch(i){console.log(i),v({text:o("api."+(((a=(u=i==null?void 0:i.response)==null?void 0:u.data)==null?void 0:a.message)||"unknownError")),snackbarProps:{color:"red"}})}}}),Z=async t=>{var e,u;try{const a={eventId:t._id,userId:M.id};await y.post("/user/join-event",a),v({text:o("event.joinSuccess"),snackbarProps:{color:"green"}})}catch(a){v({text:o("api."+(((u=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:u.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(t,e)=>{const u=ee("VueFileAgent");return ae(),te(ue,null,[l(ke,{class:"backgroundIMG",style:{"margin-left":"0px","margin-right":"0px","max-width":"1903px"}},{default:n(()=>[l(D,{style:{position:"relative",top:"80px"}},{default:n(()=>[l(U,{cols:"12"},{default:n(()=>[p("h1",$e,m(t.$t("nav.adminEvents")),1)]),_:1}),l(ge),l(U,{cols:"12"},{default:n(()=>[l(fe,{items:$,headers:G.value,search:F.value,"items-per-page":"5",style:{border:"5px solid #D1C18B"}},le({top:n(()=>[l(be,null,{default:n(()=>[l(V,{onClick:e[0]||(e[0]=a=>A(null))},{default:n(()=>[s(m(t.$t("adminEvent.new")),1)]),_:1}),l(ne),l(b,{modelValue:F.value,"onUpdate:modelValue":e[1]||(e[1]=a=>F.value=a),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.name":n(({value:a})=>[s(m(a),1)]),"item.image":n(({value:a})=>[l(re,{src:a,height:"50"},null,8,["src"])]),"item.date":n(({value:a})=>[s(m(new Date(a).toLocaleDateString()),1)]),"item.price":n(({value:a})=>[s(m(a),1)]),"item.join":n(({item:a})=>[l(V,{class:"bg-primary-darken-1",variant:"text",onClick:i=>Z(a)},{default:n(()=>e[12]||(e[12]=[s("加入")])),_:2},1032,["onClick"])]),_:2},[r(M).role===1?{name:"item.edit",fn:n(({item:a})=>[l(V,{icon:"mdi-pencil",variant:"text",onClick:i=>A(a)},null,8,["onClick"])]),key:"0"}:void 0]),1032,["items","headers","search"])]),_:1})]),_:1}),l(D,null,{default:n(()=>e[13]||(e[13]=[s(" ")])),_:1}),l(D,null,{default:n(()=>e[14]||(e[14]=[s(" ")])),_:1}),l(D,{class:"pt-3"},{default:n(()=>[l(U,null,{default:n(()=>[l(z,{class:"bg-primary"},{default:n(()=>[l(L,{style:{"text-align":"center"}},{default:n(()=>e[15]||(e[15]=[s("注意事項:")])),_:1}),l(O,{style:{"text-align":"center"}},{default:n(()=>e[16]||(e[16]=[s("1. 安全須知: "),p("br",null,null,-1),s(" 裝備準備：生存遊戲可能需要特定的裝備，例如防水衣物、登山靴、急救包、食物和水等。"),p("br",null,null,-1),s(" 環境危險：如果是在野外環境進行遊戲，需了解可能的危險，如野生動物、天氣變化、地形隱患等。"),p("br",null,null,-1),s(" 急救常識：在遇到意外情況時，懂得一些急救技能，如處理割傷、骨折、脫水等狀況。"),p("br",null,null,-1),s(" 2. 心理挑戰: "),p("br",null,null,-1),s(" 應對壓力：生存遊戲中的不確定性和挑戰會考驗你的心理素質，如何保持冷靜並作出正確決策是非常重要的。"),p("br",null,null,-1),s(" 耐性和毅力：遊戲過程中可能會遇到困難，鍾大智需要保持毅力，面對挑戰不輕言放棄。"),p("br",null,null,-1),s(" 3. 倫理和規範: "),p("br",null,null,-1),s(" 遵守規則：遊戲中通常有明確的行為規範，避免作弊或不公平行為，尊重其他玩家。"),p("br",null,null,-1),s(" 尊重環境：如果遊戲進行在戶外，要注意環保和可持續性，避免破壞自然環境。"),p("br",null,null,-1)])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(ie,{modelValue:d.value.open,"onUpdate:modelValue":e[11]||(e[11]=a=>d.value.open=a),persistent:"","max-width":"600px"},{default:n(()=>[l(ce,{disabled:r(B),onSubmit:oe(r(N),["prevent"])},{default:n(()=>[l(z,null,{default:n(()=>[l(L,null,{default:n(()=>[s(m(d.value.id?t.$t("adminEvent.edit"):t.$t("adminEvent.new")),1)]),_:1}),l(O,null,{default:n(()=>[l(b,{modelValue:r(w).value.value,"onUpdate:modelValue":e[2]||(e[2]=a=>r(w).value.value=a),label:t.$t("event.name"),"error-messages":r(w).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(Ve,{modelValue:r(E).value.value,"onUpdate:modelValue":e[3]||(e[3]=a=>r(E).value.value=a),"item-title":"text",items:Q,label:t.$t("event.status"),"error-messages":r(E).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(b,{modelValue:r(x).value.value,"onUpdate:modelValue":e[4]||(e[4]=a=>r(x).value.value=a),label:t.$t("event.date"),"error-messages":r(x).errorMessage.value,type:"date"},null,8,["modelValue","label","error-messages"]),l(b,{modelValue:r(S).value.value,"onUpdate:modelValue":e[5]||(e[5]=a=>r(S).value.value=a),label:t.$t("event.location"),"error-messages":r(S).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(ye,{modelValue:r(C).value.value,"onUpdate:modelValue":e[6]||(e[6]=a=>r(C).value.value=a),label:t.$t("event.description"),"error-messages":r(C).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(b,{modelValue:r(q).value.value,"onUpdate:modelValue":e[7]||(e[7]=a=>r(q).value.value=a),label:t.$t("event.price"),"error-messages":r(q).errorMessage.value,type:"number"},null,8,["modelValue","label","error-messages"]),l(u,{ref_key:"fileAgent",ref:P,modelValue:c.value,"onUpdate:modelValue":e[8]||(e[8]=a=>c.value=a),"raw-model-value":I.value,"onUpdate:rawModelValue":e[9]||(e[9]=a=>I.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":t.$t("fileAgent.helpText"),"error-text":{type:t.$t("fileAgent.errorType"),size:t.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),l(se,null,{default:n(()=>[l(V,{onClick:T},{default:n(()=>[s(m(t.$t("adminEvent.cancel")),1)]),_:1}),l(V,{type:"submit",loading:r(B),onClick:e[10]||(e[10]=a=>r(j)(r(N)))},{default:n(()=>[s(m(t.$t("adminEvent.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof h=="function"&&h(we);export{we as default};
